{"Name":"p3dmakedoc","Comment":"","Uses":["Classes","SysUtils","CustApp","LazFileUtils","p3dparsepascal","p3dparsedoc"],"Types":{"TP3DCommandType":{"EnumValues":["ctShowHelp","ctParsePascal"],"NodeType":"EnumerationType","Code":"TP3DCommandType=(ctShowHelp,ctParsePascal);","SourcePos":"p3dmakedoc.lpr (13)"},"TP3DCommand":{"NodeType":"Class","Published":{"Fields":{"CmdType":{"Type":{"Name":"TP3DCommandType","NodeType":"TypeReference","Context":".Types.TP3DCommandType"},"Code":"CmdType:TP3DCommandType;","SourcePos":"p3dmakedoc.lpr (18)"},"InputFiles":{"Type":{"Name":"TStringList","NodeType":"TypeReference"},"Code":"InputFiles:TStringList;","SourcePos":"p3dmakedoc.lpr (19)"},"OutputDir":{"Type":{"Name":"String","NodeType":"TypeReference"},"Code":"OutputDir:String;","SourcePos":"p3dmakedoc.lpr (20)"}},"Methods":{"Destroy":{"Code":"destructor Destroy;override;","SourcePos":"p3dmakedoc.lpr (22)","NodeType":"Procedure"}}},"Code":"TP3DCommand=class CmdType:TP3DCommandType;InputFiles:TStringList;OutputDir:String;destructor Destroy;override;end;","SourcePos":"p3dmakedoc.lpr (17)"},"TP3DMakeDoc":{"NodeType":"Class","Parent":[{"Name":"TCustomApplication","NodeType":"TypeReference"}],"Published":{},"Protected":{"Methods":{"DoRun":{"Code":"procedure DoRun;override;","SourcePos":"p3dmakedoc.lpr (29)","NodeType":"Procedure"}}},"Public":{"Methods":{"Create":{"Code":"constructor Create(TheOwner:TComponent);override;","SourcePos":"p3dmakedoc.lpr (32)","Params":{"TheOwner":{"Type":{"Name":"TComponent","NodeType":"TypeReference"},"Code":"TheOwner:TComponent","SourcePos":"p3dmakedoc.lpr (32)"}},"NodeType":"Procedure"},"Destroy":{"Code":"destructor Destroy;override;","SourcePos":"p3dmakedoc.lpr (33)","NodeType":"Procedure"},"WriteHelp":{"Code":"procedure WriteHelp;virtual;","SourcePos":"p3dmakedoc.lpr (34)","NodeType":"Procedure"}}},"Code":"TP3DMakeDoc=class(TCustomApplication)protected procedure DoRun;override;public constructor Create(TheOwner:TComponent);override;destructor Destroy;override;procedure WriteHelp;virtual;end;","SourcePos":"p3dmakedoc.lpr (27)"}},"Functions":{"Destroy":{"Code":"destructor TP3DMakeDoc.Destroy;begin inherited Destroy;end","SourcePos":"p3dmakedoc.lpr (141)","NodeType":"Procedure"},"DoRun":{"Code":"procedure TP3DMakeDoc.DoRun;var FileName,OutFile:String;i,j:Integer;Ext:RawByteString;Commands:array of TP3DCommand;CurrentCommand:TP3DCommand;procedure NewCommand(CT:TP3DCommandType);begin SetLength(Commands,Length(Commands)+1);CurrentCommand:=TP3DCommand.Create;CurrentCommand.CmdType:=CT;CurrentCommand.InputFiles:=TStringList.Create;;Commands[High(Commands)]:=CurrentCommand;CurrentCommand.OutputDir:=GetCurrentDirUTF8;end;begin P3DParsePascalInit;i:=1;try while i<=Paramcount do begin case ParamStr(i)of'-h','--help':NewCommand(ctShowHelp);'parse':NewCommand(ctParsePascal);else begin if(not Assigned(CurrentCommand))then raise Exception.Create('No command defined!')else if(ParamStr(i)='-o')then begin Inc(i);CurrentCommand.OutputDir:=ParamStr(i);end else CurrentCommand.InputFiles.Add(ParamStr(i));end;end;Inc(i);end;for i:=0 to high(Commands)do begin CurrentCommand:=Commands[i];for j:=0 to CurrentCommand.InputFiles.Count-1 do begin FileName:=CurrentCommand.InputFiles[j];Ext:=ExtractFileExt(Filename);OutFile:=AppendPathDelim(CurrentCommand.OutputDir)+ExtractFileNameOnly(Filename);case CurrentCommand.CmdType of ctShowHelp:WriteHelp;ctParsePascal:case(Ext)of'.pas','.pp':ParsePascalUnit(Filename,OutFile);'.lpi','.lpr':ParsePascalProgram(FileName,OutFile);'.lpk':ParsePascalPackage(FileName,OutFile);else WriteLn('Unsupported file extension: '+Ext);end;end;end;end;finally for i:=0 to High(Commands)do Commands[i].Free;end;P3DParsePascalFinish;Terminate;end","SourcePos":"p3dmakedoc.lpr (47)","NodeType":"Procedure"},"Create":{"Code":"constructor TP3DMakeDoc.Create(TheOwner:TComponent);begin inherited Create(TheOwner);StopOnException:=True;end","SourcePos":"p3dmakedoc.lpr (135)","Params":{"TheOwner":{"Type":{"Name":"TComponent","NodeType":"TypeReference"},"Code":"TheOwner:TComponent","SourcePos":"p3dmakedoc.lpr (135)"}},"NodeType":"Procedure"},"WriteHelp":{"Code":"procedure TP3DMakeDoc.WriteHelp;begin end","SourcePos":"p3dmakedoc.lpr (146)","NodeType":"Procedure"}},"Vars":{"Application":{"Type":{"Name":"TP3DMakeDoc","NodeType":"TypeReference","Context":".Types.TP3DMakeDoc"},"Code":"Application:TP3DMakeDoc;","SourcePos":"p3dmakedoc.lpr (152)"}}}